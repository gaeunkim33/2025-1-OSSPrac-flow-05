<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='share.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='input.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Jockey+One&display=swap" rel="stylesheet">
    <title>í•™ìƒ ì •ë³´ ì…ë ¥</title>
    <style>
        .label {
            width: 140px;
            text-align: right;
            padding-right: 5px;
            display: inline-block;
        }
        .flow-text {
            font-family: 'Jockey One', sans-serif;
            color: #ff4d73;
            font-size: 50px;
        }
    </style>
    <script>
        // í¼ ì œì¶œ ì‹œ ë¶€ëª¨ ì°½ ë¦¬ë‹¤ì´ë ‰íŠ¸í•˜ê³  í˜„ì¬ ì°½ ë‹«ê¸°
        function submitAndClose(event) {
            event.preventDefault();
            const form = document.getElementById('studentForm');
            const formData = new FormData(form);
            
            // í¼ ë°ì´í„° ì œì¶œ
            fetch('/result', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    // ë¶€ëª¨ ì°½ ë¦¬ë‹¤ì´ë ‰íŠ¸
                    if (window.opener) {
                        window.opener.location.href = '/result';
                        // í˜„ì¬ ì°½ ë‹«ê¸°
                        window.close();
                    } else {
                        // íŒì—…ì´ ì•„ë‹Œ ê²½ìš° í˜„ì¬ ì°½ ë¦¬ë‹¤ì´ë ‰íŠ¸
                        window.location.href = '/result';
                    }
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('ì œì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
            
            return false;
        }
    </script>
</head>
<body>
    <h1><span class="flow-text">flow</span>ì— ë‹¹ì‹ ì„ ì—°ê²°í•´ì£¼ì„¸ìš”ğŸ˜</h1>
    <form action="/result" method="POST" id="studentForm" enctype="multipart/form-data" class="form-container" onsubmit="return submitAndClose(event)">
        <div id="personContainer">
            <div class="person-block">
                <div class="person-header">
                </div>
                <p><span class="label">ì´ë¦„:</span> <input type="text" name="name[]" required placeholder="ê¹€ë™êµ­"></p>
                <p><span class="label">í•™ë²ˆ:</span> <input type="text" name="StudentNumber[]" required placeholder="2025000000"></p>
                <p><span class="label">ì„±ë³„:</span>
                    <input type="radio" name="gender_0" value="male" required, checked> ë‚¨ì„±
                    <input type="radio" name="gender_0" value="female"> ì—¬ì„±
                </p>
                <p><span class="label">ì „í™”ë²ˆí˜¸:</span> <input type="tel" name="tel[]" required placeholder="010-1234-5678"></p>
                <p><span class="label">ì´ë©”ì¼:</span> <input type="email" name="email[]" required placeholder="example@dgu.ac.kr"></p>
                <p><span class="label">ì „ê³µ:</span> <input type="text" name="major[]" required placeholder="ì»´í“¨í„°ê³µí•™ê³¼"></p>
                
                <p><span class="label">í”„ë¡œê·¸ë¨ ì–¸ì–´:</span>
                    <input type="checkbox" name="language_0" value="python"> Python
                    <input type="checkbox" name="language_0" value="java"> Java
                    <input type="checkbox" name="language_0" value="javascript"> JavaScript
                    <input type="checkbox" name="language_0" value="c"> C
                    <input type="checkbox" name="language_0" value="c++"> C++
                </p>
                <p><span class="label">MBTI:</span>
                    <select name="mbti[]" required>
                      <option value="" disabled selected>ì„ íƒí•˜ì„¸ìš”</option>
                      <optgroup label="ë¶„ì„ê°€">
                        <option value="INTJ">INTJ</option>
                        <option value="INTP">INTP</option>
                        <option value="ENTJ">ENTJ</option>
                        <option value="ENTP">ENTP</option>
                      </optgroup>
                      <optgroup label="ì™¸êµê´€">
                        <option value="INFJ">INFJ</option>
                        <option value="INFP">INFP</option>
                        <option value="ENFJ">ENFJ</option>
                        <option value="ENFP">ENFP</option>
                      </optgroup>
                      <optgroup label="ê´€ë¦¬ì">
                        <option value="ISTJ">ISTJ</option>
                        <option value="ISFJ">ISFJ</option>
                        <option value="ESTJ">ESTJ</option>
                        <option value="ESFJ">ESFJ</option>
                      </optgroup>
                      <optgroup label="íƒí—˜ê°€">
                        <option value="ISTP">ISTP</option>
                        <option value="ISFP">ISFP</option>
                        <option value="ESTP">ESTP</option>
                        <option value="ESFP">ESFP</option>
                      </optgroup>
                    </select>
                </p>
                <p><span class="label">ì¢‹ì•„í•˜ëŠ” ìƒ‰ê¹”:</span> <input type="color" name="color[]" required value="#f9f9f9"></p>
                <p><span class="label">ì‚¬ì§„ ì—…ë¡œë“œ:</span> <input type="file" name="photo[]" accept="image/*"></p>
                <div class="delete-btn-container">
                    <button type="delete" class="delete-btn" onclick="deletePerson(this)">ì‚­ì œ</button>
                </div>
            </div>
        </div>
        <div class="button-container">
            <button type="button" onclick="addPerson()">ì¶”ê°€</button>
            <button type="submit">ì œì¶œ</button>
        </div>
    </form>

    <script>
    let personCount = 0;

    function addPerson() {
        personCount++;
        const container = document.getElementById("personContainer");
        const personBlock = document.createElement("div");
        personBlock.className = "person-block";
        personBlock.innerHTML = `
            <div class="person-header">
            </div>
            <p><span class="label">ì´ë¦„:</span> <input type="text" name="name[]" required placeholder="ê¹€ë™êµ­"></p>
            <p><span class="label">í•™ë²ˆ:</span> <input type="text" name="StudentNumber[]" required placeholder="2025000000"></p>
            <p><span class="label">ì„±ë³„:</span>
                <input type="radio" name="gender_${personCount}" value="male" required, checked> ë‚¨ì„±
                <input type="radio" name="gender_${personCount}" value="female"> ì—¬ì„±
            </p>
            <p><span class="label">ì „í™”ë²ˆí˜¸:</span> <input type="tel" name="tel[]" required placeholder="010-1234-5678"></p>
            <p><span class="label">ì´ë©”ì¼:</span> <input type="email" name="email[]" required placeholder="example@dgu.ac.kr"></p>
            <p><span class="label">ì „ê³µ:</span> <input type="text" name="major[]" required placeholder="ì»´í“¨í„°ê³µí•™ê³¼"></p>
            <p><span class="label">í”„ë¡œê·¸ë¨ ì–¸ì–´:</span>
                <input type="checkbox" name="language_${personCount}" value="python"> Python
                <input type="checkbox" name="language_${personCount}" value="java"> Java
                <input type="checkbox" name="language_${personCount}" value="javascript"> JavaScript
                <input type="checkbox" name="language_${personCount}" value="c"> C
                <input type="checkbox" name="language_${personCount}" value="c++"> C++
            </p>
            <p><span class="label">MBTI:</span>
                <select name="mbti[]" required>
                    <option value="" disabled selected>ì„ íƒí•˜ì„¸ìš”</option>
                    <optgroup label="ë¶„ì„ê°€">
                        <option value="INTJ">INTJ</option>
                        <option value="INTP">INTP</option>
                        <option value="ENTJ">ENTJ</option>
                        <option value="ENTP">ENTP</option>
                    </optgroup>
                    <optgroup label="ì™¸êµê´€">
                        <option value="INFJ">INFJ</option>
                        <option value="INFP">INFP</option>
                        <option value="ENFJ">ENFJ</option>
                        <option value="ENFP">ENFP</option>
                    </optgroup>
                    <optgroup label="ê´€ë¦¬ì">
                        <option value="ISTJ">ISTJ</option>
                        <option value="ISFJ">ISFJ</option>
                        <option value="ESTJ">ESTJ</option>
                        <option value="ESFJ">ESFJ</option>
                    </optgroup>
                    <optgroup label="íƒí—˜ê°€">
                        <option value="ISTP">ISTP</option>
                        <option value="ISFP">ISFP</option>
                        <option value="ESTP">ESTP</option>
                        <option value="ESFP">ESFP</option>
                    </optgroup>
                </select>
            </p>
            <p><span class="label">ì¢‹ì•„í•˜ëŠ” ìƒ‰ê¹”:</span> <input type="color" name="color[]" required value="#f9f9f9"></p>    
            <p><span class="label">ì‚¬ì§„ ì—…ë¡œë“œ:</span> <input type="file" name="photo[]" accept="image/*"></p>
            <div class="delete-btn-container">
                <button type="delete" class="delete-btn" onclick="deletePerson(this)">ì‚­ì œ</button>
            </div>
        `;

        container.appendChild(personBlock);
    }
    
    function deletePerson(button) {
        const personBlock = button.closest('.person-block');
        if (personBlock) {
            personBlock.remove();
        }
    }
    </script>
    </body>
    </html>
